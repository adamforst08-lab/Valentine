<script>
let noCount = 0;
let answered = false;

// Change her name here ğŸ’•
const herName = "My Love";

// Check if already answered
if (localStorage.getItem('answered') === 'yes') {
    setTimeout(() => handleYes(true), 300);
}

// Floating hearts
function createFloatingHearts() {
    const container = document.getElementById('heartsBg');
    const hearts = ['ğŸ’•','ğŸ’–','ğŸ’—','ğŸ’','â¤ï¸','ğŸ©·','ğŸŒ¸','âœ¨'];
    for (let i = 0; i < 25; i++) {
        const heart = document.createElement('div');
        heart.className = 'floating-heart';
        heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
        heart.style.left = Math.random() * 100 + '%';
        heart.style.fontSize = (15 + Math.random() * 20) + 'px';
        heart.style.animationDuration = (6 + Math.random() * 8) + 's';
        heart.style.animationDelay = Math.random() * 10 + 's';
        container.appendChild(heart);
    }
}

function showSpeechBubble(text) {
    const bubble = document.getElementById('speechBubble');
    bubble.textContent = text;
    bubble.style.display = 'block';
}

function setExpression(type) {
    ['eyesNormal','eyesHappy','eyesSad','eyesCrying',
     'sadMouth','cryingMouth'].forEach(id=>{
        document.getElementById(id).style.display='none';
    });

    if(type==='happy'){
        document.getElementById('eyesHappy').style.display='block';
        document.getElementById('armsNormal').style.display='none';
        document.getElementById('armsFlower').style.display='block';
    }
    else if(type==='sad'){
        document.getElementById('eyesSad').style.display='block';
        document.getElementById('sadMouth').style.display='block';
    }
    else if(type==='crying'){
        document.getElementById('eyesCrying').style.display='block';
        document.getElementById('cryingMouth').style.display='block';
    }
    else{
        document.getElementById('eyesNormal').style.display='block';
    }
}

function createConfetti(){
    const container=document.getElementById('celebration');
    for(let i=0;i<60;i++){
        const confetti=document.createElement('div');
        confetti.className='confetti';
        confetti.style.left=Math.random()*100+'%';
        confetti.style.background=`hsl(${Math.random()*360},100%,60%)`;
        confetti.style.animationDuration=(2+Math.random()*2)+'s';
        container.appendChild(confetti);
        setTimeout(()=>confetti.remove(),4000);
    }
}

function handleYes(skipSound=false){
    if(answered) return;
    answered=true;

    localStorage.setItem('answered','yes');

    setExpression('happy');
    showSpeechBubble("Yay! I love you ğŸ’•");

    document.getElementById('mainTitle').textContent =
        `ğŸ’• ${herName} Said Yes! ğŸ’•`;

    document.getElementById('subtitle').textContent =
        "You just made me the happiest person alive ğŸ’–";

    document.getElementById('buttonsContainer').style.display='none';
    document.getElementById('finalMessage').style.display='block';

    if(!skipSound){
        document.getElementById('yesSound').play();
    }

    createConfetti();
    setTimeout(createConfetti,1500);
}

function handleNo(){
    if(answered) return;

    noCount++;
    const btnNo=document.getElementById('btnNo');
    const btnYes=document.getElementById('btnYes');

    if(noCount===1){
        setExpression('sad');
        showSpeechBubble("Are you sure? ğŸ¥º");
        btnNo.textContent="Still No ğŸ˜¢";
    }
    else{
        setExpression('crying');
        showSpeechBubble("Please click yes ğŸ¥ºğŸ’•");

        // Moving prank
        btnNo.style.position='absolute';
        btnNo.style.left=Math.random()*80+'%';
        btnNo.style.top=Math.random()*70+'%';

        btnYes.style.transform='scale(1.3)';
        btnYes.textContent="Okay fine, YES ğŸ’•";
    }
}

// Secret message unlock (press H key 3 times)
let secretCount=0;
document.addEventListener('keydown',(e)=>{
    if(e.key.toLowerCase()==='h'){
        secretCount++;
        if(secretCount===3){
            alert("Secret message: I would choose you in every lifetime ğŸ’•");
            secretCount=0;
        }
    }
});

createFloatingHearts();
setExpression('normal');
</script>